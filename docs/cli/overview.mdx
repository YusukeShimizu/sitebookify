---
title: CLI Overview
description: Commands and the end-to-end workflow.
---

Sitebookify is a CLI-only tool (MVP).

## Compile and run from source

```sh
nix develop -c cargo build --release
./target/release/sitebookify --help
```

If you want to run via Cargo:

```sh
nix develop -c cargo run -- crawl --url https://example.com/docs/ --out raw
```

## Workflow

The typical workflow is:

0. `build` (one-shot: runs everything into a workspace directory)
1. `crawl` (Raw snapshot)
2. `extract` (Extracted Pages snapshot)
3. `manifest` (JSONL index)
4. `toc create` (YAML chapter + section layout)
5. `book init` (mdBook skeleton)
6. `book render` (rewrite sections + generate `book/src/`)
7. `book bundle` (single Markdown file + assets)

## Commands

### `build`

Run the full pipeline (crawl → extract → manifest → toc create → book (init/render) → bundle) in one command.

```sh
sitebookify build \
  --url https://example.com/docs/ \
  --out workspace \
  --language 日本語 \
  --tone 丁寧
# --title is optional (derived from toc.yaml / LLM)
```

Workspace layout (MVP):

```text
<out>/
  raw/
  extracted/
  manifest.jsonl
  toc.yaml
  book/
  assets/
  book.md
```

Notes (MVP):

- Workspaces are write-once: if `--out` already exists, `build` fails.
- Crawl flags (`--max-pages`, `--max-depth`, `--concurrency`, `--delay-ms`) are supported.
- `--toc-engine` and `--render-engine` accept `openai` or `noop` (default: `openai`).
- OpenAI settings (CLI):
  - `SITEBOOKIFY_OPENAI_BIN` (default: prefer `codex`, fallback: `openai`)
  - `SITEBOOKIFY_OPENAI_MODEL` (optional)
  - `SITEBOOKIFY_OPENAI_REASONING_EFFORT` (optional; e.g. `minimal`, `low`, `medium`, `high`, `xhigh`)

### `crawl`

Fetch pages under the start URL and save HTML into a Raw snapshot directory.

```sh
sitebookify crawl \
  --url https://example.com/docs/ \
  --out raw
```

Notes (MVP):

- URL normalization removes query strings (`?...`), fragments (`#...`), and trailing slashes (except `/`).
- Only the same origin and the start path subtree are crawled.
- Only `text/html` responses are saved as Raw HTML.
- Raw snapshots are write-once: if `--out` already exists, `crawl` fails.
- Crawling uses `spider` (spider-rs).

Main flags:

- `--max-pages` (default: 200)
- `--max-depth` (default: 8)
- `--concurrency` (default: 4)
- `--delay-ms` (default: 200)

### `extract`

Convert Raw HTML files into Extracted Pages (Markdown with YAML front matter).

```sh
sitebookify extract --raw raw --out extracted
```

Notes (MVP):

- Extracted snapshots are write-once: if `--out` already exists, `extract` fails.
- Main content extraction uses Mozilla Readability (Firefox Reader Mode) via `readability-js`.

### `manifest`

Build `manifest.jsonl` from `extracted/pages/*.md`.

```sh
sitebookify manifest --extracted extracted --out manifest.jsonl
```

### `toc create`

Generate `toc.yaml` from `manifest.jsonl`.

```sh
sitebookify toc create --manifest manifest.jsonl --out toc.yaml --language 日本語 --tone 丁寧 --engine openai
```

If you want to override the generated book title:

```sh
sitebookify toc create --manifest manifest.jsonl --out toc.yaml --book-title "My Book" --language 日本語 --tone 丁寧 --engine openai
```

### `book init`

Create an mdBook skeleton.

```sh
sitebookify book init --out book --title "Example Docs Textbook"
```

### `book render`

Render chapters based on `toc.yaml` and `manifest.jsonl`.

```sh
sitebookify book render --toc toc.yaml --manifest manifest.jsonl --out book --language 日本語 --tone 丁寧 --engine openai
```

Notes (MVP):

- `book/` is treated as generated output.
- Every generated chapter includes a `## Sources` section.
